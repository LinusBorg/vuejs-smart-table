var e,t,s=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,r=Object.prototype.propertyIsEnumerable,o=(e,t,a)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,i=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&o(e,s,t[s]);if(l)for(var s of l(t))r.call(t,s)&&o(e,s,t[s]);return e};import{reactive as n,computed as c,watch as u,defineComponent as d,provide as h,toRef as g,h as p,inject as f,ref as v,onMounted as w,nextTick as y,isVue2 as P,useAttrs as S,install as m}from"vue-demi";function b(e,t){const s=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split(".");let a=e;for(const l of s){if(!(l in a))return;a=a[l]}return a}function R(e){return!Array.isArray(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function C(e,t){if(function(e){return e&&"function"==typeof e.custom}(t)&&!t.custom(t.value,e))return!1;if(!function(e){return Array.isArray(e.keys)}(t)||null===t.value||void 0===t.value||0===t.value.length)return!0;for(const s of t.keys){const a=b(e,s);if(null!=a){const e=Array.isArray(t.value)?t.value:[t.value];for(const s of e)if(t.exact){if(a.toString()===s.toString())return!0}else if(a.toString().toLowerCase().includes(s.toString().toLowerCase()))return!0}}return!1}(t=e||(e={}))[t.DESC=-1]="DESC",t[t.NONE=0]="NONE",t[t.ASC=1]="ASC";class O{constructor(t){this.state=n({data:[],filters:{},selectedRows:[],selectionMode:"single",selectOnClick:!0,selectedClass:"",hideSortIcons:!1,sortId:null,sortKey:null,customSort:null,sortOrder:e.NONE,currentPage:0,pageSize:void 0,sortIconPosition:"after",sortHeaderClass:"",headlessMode:!1}),this.emit=t,this.filteredData=c((()=>0===this.state.data.length?[]:0===Object.keys(this.state.filters).length?this.state.data:function(e,t){const s=[];for(const a of e){let e=!0;for(const s of Object.keys(t))if(!C(a,t[s])){e=!1;break}e&&s.push(a)}return s}(this.state.data,this.state.filters))),this.sortedData=c((()=>{return(this.state.sortKey||this.state.customSort)&&0!==this.state.sortOrder?(e=this.filteredData.value,t=this.state.sortKey,s=this.state.customSort,a=this.state.sortOrder,[...e].sort(((e,l)=>{if("function"==typeof s)return s(e,l,a);let r,o;if(t?"function"==typeof t?(r=t(e,a),o=t(l,a)):(r=b(e,t),o=b(l,t)):(r=null,o=null),null==r&&(r=""),null==o&&(o=""),R(r)&&R(o))return(r-o)*a;const i=r.toString(),n=o.toString();return i.localeCompare(n)*a}))):this.filteredData.value;var e,t,s,a})),this.totalItems=c((()=>this.filteredData.value.length)),this.totalPages=c((()=>{return this.state.pageSize?(e=this.totalItems.value,t=this.state.pageSize,e<=t?1:Math.ceil(e/t)):0;var e,t})),u(this.totalPages,(e=>{this.emit("totalPagesChanged",e)}),{immediate:!0}),this.paginationEnabled=c((()=>this.state.pageSize));const s=c((()=>this.paginationEnabled.value&&this.state.currentPage>this.totalPages.value));u(s,(e=>{e&&this.paginationEnabled.value&&(this.state.currentPage=1,this.emit("update:currentPage",this.state.currentPage))})),this.displayData=c((()=>this.paginationEnabled.value?function(e,t,s){if(e.length<=t||t<=0||s<=0)return e;const a=(s-1)*t,l=a+t;return[...e].slice(a,l)}(this.sortedData.value,this.state.pageSize,this.state.currentPage):this.sortedData.value)),u(this.displayData,(e=>{this.emit("totalItemsChanged",e.length)})),this.tableState=c((()=>({rows:this.displayData.value,rowsPrePagination:this.sortedData.value,selectedRows:this.state.selectedRows}))),u(this.tableState,(e=>{this.emit("stateChanged",e)}),{immediate:!0,deep:!0})}revealItem(e){if(!this.paginationEnabled.value)return!1;let t;return t="function"==typeof e?this.sortedData.value.findIndex(e):this.sortedData.value.indexOf(e),-1!==t&&(this.emit("update:currentPage",Math.ceil((t+1)/this.state.pageSize)),!0)}selectRow(e){"single"!==this.state.selectionMode?this.state.selectedRows.includes(e)||this.state.selectedRows.push(e):this.state.selectedRows=[e]}selectRows(e){for(const t of e)this.selectRow(t)}deselectRow(e){const t=this.state.selectedRows.indexOf(e);t>-1&&this.state.selectedRows.splice(t,1)}deselectRows(e){for(const t of e)this.deselectRow(t)}selectAll(){"single"!==this.state.selectionMode&&(this.state.selectedRows=[...this.state.data])}deselectAll(){this.state.selectedRows=[]}setSort({sortKey:e,customSort:t,sortOrder:s,sortId:a}){this.state.sortKey=e,this.state.customSort=t,this.state.sortOrder=s,this.state.sortId=a}syncProp(e,t,s=!1){u(t,(()=>{this.state[e]=t.value}),{immediate:!0,deep:s})}}const A=Symbol("store-key");var k=d({name:"VTable",props:{data:{type:Array,required:!0},filters:{type:Object,required:!1,default:()=>({})},currentPage:{type:Number,required:!1,default:void 0},pageSize:{type:Number,required:!1,default:void 0},selectionMode:{type:String,required:!1,default:"single",validator:e=>["single","multiple"].includes(e)},selectedClass:{required:!1,type:String,default:"vt-selected"},selectOnClick:{required:!1,type:Boolean,default:!0},hideSortIcons:{required:!1,type:Boolean,default:!1},sortIconPosition:{required:!1,type:String,default:"after"},sortHeaderClass:{type:String,required:!1,default:""},headlessMode:{type:Boolean,required:!1,default:!1}},emits:{stateChanged:e=>!0,totalPagesChanged:e=>!0,totalItemsChanged:e=>!0},setup(e,t){const s=new O(t.emit);h(A,s),s.syncProp("data",g(e,"data")),s.syncProp("filters",g(e,"filters"),!0),s.syncProp("currentPage",g(e,"currentPage")),s.syncProp("pageSize",g(e,"pageSize")),s.syncProp("selectionMode",g(e,"selectionMode")),s.syncProp("selectedClass",g(e,"selectedClass")),s.syncProp("selectOnClick",g(e,"selectOnClick")),s.syncProp("hideSortIcons",g(e,"hideSortIcons")),s.syncProp("sortIconPosition",g(e,"sortIconPosition")),s.syncProp("sortHeaderClass",g(e,"sortHeaderClass")),s.syncProp("headlessMode",g(e,"headlessMode"));const a=c((()=>s.state.selectedRows.length===s.state.data.length));return{store:s,tableState:s.tableState,allRowsSelected:a,toggleAllRows:()=>a.value?s.deselectAll():s.selectAll(),selectAll:()=>s.selectAll(),deselectAll:()=>s.deselectAll(),selectRows:e=>s.selectRows(e),selectRow:e=>s.selectRow(e),deselectRows:e=>s.deselectRows(e),deselectRow:e=>s.deselectRow(e),revealItem:e=>s.revealItem(e),slots:t.slots}},render(){return p("table",{class:"v-table"},[p("thead",this.slots.head?this.slots.head({rows:this.tableState.rows,selectedRows:this.tableState.selectedRows,toggleAllRows:this.toggleAllRows,selectAll:this.selectAll,deselectAll:this.deselectAll,allRowsSelected:this.allRowsSelected}):void 0),p("tbody",this.slots.body?this.slots.body({rows:this.tableState.rows,selectedRows:this.tableState.selectedRows,selectRow:this.selectRow,deselectRow:this.deselectRow}):void 0),p("tfoot",this.slots.foot?this.slots.foot({rows:this.tableState.rows,selectedRows:this.tableState.selectedRows,toggleAllRows:this.toggleAllRows,selectAll:this.selectAll,deselectAll:this.deselectAll,allRowsSelected:this.allRowsSelected}):void 0)])}});function L(e){var t;const s={width:16,height:16,xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${e.vbWidth} ${e.vbHeight}`},a={fill:"currentColor",d:e.d,opacity:null!=(t=e.opacity)?t:1};return p("svg",i(i({attrs:s},s),{style:i({},e.disabled?{color:"#9CA3AF"}:{})}),[p("path",i({attrs:a},a))])}var I=d({name:"VTh",props:{sortKey:{type:[String,Function],required:!1,default:null},customSort:{type:[Function,Object],required:!1,default:null},defaultSort:{type:String,required:!1,validator:e=>["asc","desc",null].includes(e),default:null}},emits:["defaultSort","sortChanged"],setup(t,{emit:s,slots:a}){const l=f(A);if(!t.sortKey&&!t.customSort)throw new Error("Must provide the Sort Key value or a Custom Sort function.");const r="_"+Math.random().toString(36).substr(2,9),o=v(e.NONE);w((()=>{t.defaultSort&&(o.value="desc"===t.defaultSort?e.DESC:e.ASC,l.setSort({sortOrder:o.value,sortKey:t.sortKey,customSort:t.customSort,sortId:r}),y((()=>{s("defaultSort"),s("sortChanged",{sortOrder:o.value})})))}));const n=c((()=>{if(!l.state.hideSortIcons)return function(t){const s={width:16,height:16,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512"},a=()=>({fill:"currentColor",opacity:t===e.NONE||t===e.ASC?.4:1,d:"M41.05 288.05h238c21.4 0 32.1 25.9 17 41l-119 119a23.9 23.9 0 0 1-33.8.1l-.1-.1-119.1-119c-15.05-15.05-4.4-41 17-41z"}),l=()=>({fill:"currentColor",opacity:t===e.NONE||t===e.DESC?.4:1,d:"M24.05 183.05l119.1-119A23.9 23.9 0 0 1 177 64a.94.94 0 0 1 .1.1l119 119c15.1 15.1 4.4 41-17 41h-238c-21.45-.05-32.1-25.95-17.05-41.05z"});return p("svg",i({attrs:s},s),[p("g",[p("path",i({attrs:a()},a())),p("path",i({attrs:l()},l()))])])}(o.value)}));u((()=>l.state.sortId),(()=>{l.state.sortId!==r&&0!==o.value&&(o.value=0)}));const d=()=>{[e.DESC,e.NONE].includes(o.value)?o.value=e.ASC:o.value=e.DESC,l.setSort({sortOrder:o.value,sortKey:t.sortKey,customSort:t.customSort,sortId:r}),s("sortChanged",{sortOrder:o.value})},h=c((()=>{const e=[];return"before"!==l.state.sortIconPosition||l.state.hideSortIcons||e.push(n.value),a.default&&e.push(p("span",[a.default({sortOrder:o.value})])),"after"!==l.state.sortIconPosition||l.state.hideSortIcons||e.push(n.value),e}));return()=>p("th",i({class:"v-th"},P?{on:{click:d}}:{onClick:d}),[p("div",{class:l.state.sortHeaderClass},h.value)])}}),N=d({name:"VTr",props:{row:{type:Object,required:!0}},inheritAttrs:!1,setup(e,{slots:t}){const s=f(A),o=S(),{class:n,style:u}=o,d=((e,t)=>{var s={};for(var o in e)a.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&l)for(var o of l(e))t.indexOf(o)<0&&r.call(e,o)&&(s[o]=e[o]);return s})(o,["class","style"]),h=c((()=>s.state.selectedRows.find((t=>t===e.row)))),g=c((()=>h.value?s.state.selectedClass:"")),v=c((()=>i({},s.state.selectOnClick?{cursor:"pointer"}:{}))),w=t=>{const a=t.target;a&&"td"===a.tagName.toLowerCase()&&(h.value?s.deselectRow(e.row):s.selectRow(e.row))};return()=>p("tr",i(i({class:g.value,style:v.value},s.state.selectOnClick?i({},P?{on:{click:w}}:{onClick:w}):{}),d),t.default?t.default({isSelected:h.value,toggle:()=>h.value?s.deselectRow(e.row):s.selectRow(e.row)}):[])}}),M=d({name:"VTPagination",props:{currentPage:{type:Number,required:!0},totalPages:{type:Number,required:!0},hideSinglePage:{required:!1,type:Boolean,default:!0},maxPageLinks:{required:!1,type:Number,default:NaN},boundaryLinks:{required:!1,type:Boolean,default:!1},directionLinks:{required:!1,type:Boolean,default:!0}},setup(e,{slots:t,emit:s}){const a=c((()=>isNaN(e.maxPageLinks)||e.maxPageLinks<=0?(()=>{const t=[];for(let s=1;s<=e.totalPages;s++)t.push({title:s.toString(),value:s});return t})():(()=>{const t=[],s=Math.ceil(e.totalPages/e.maxPageLinks),a=Math.ceil((e.currentPage||1)/e.maxPageLinks);let l=(a-1)*e.maxPageLinks+1;const r=Math.min(l+e.maxPageLinks-1,e.totalPages),o=r-l+1,i=e.maxPageLinks-o;a===s&&a>1&&i>0&&(l-=i),a>1&&t.push({title:"...",value:l-1});for(let n=l;n<=r&&!(n>e.totalPages);n++)t.push({title:n.toString(),value:n});return a<s&&t.push({title:"...",value:r+1}),t})())),l=t=>{t<1||t>e.totalPages||t===e.currentPage||s("update:currentPage",t)},r=()=>{e.currentPage?e.currentPage<e.totalPages&&s("update:currentPage",e.currentPage+1):s("update:currentPage",1)},o=()=>{e.currentPage?e.currentPage>1&&s("update:currentPage",e.currentPage-1):s("update:currentPage",1)},n=()=>{s("update:currentPage",1)},u=()=>{s("update:currentPage",e.totalPages)},d=(e,t,s,a=!1)=>p("li",{class:["page-item",{disabled:s,active:a}]},[p("a",i(i({class:"page-link",style:i({},s?{cursor:"not-allowed"}:{}),attrs:{href:"javascript:void(0)"},href:"javascript:void(0)"},s?{}:{onClick:t}),{on:i({},s?{}:{click:t})}),[e])]);return()=>{var s,i,c,h,g,f,v,w;if(e.hideSinglePage&&1===e.totalPages)return p("");const y=[];if(e.boundaryLinks){const a=L({vbWidth:512,vbHeight:512,d:"M34.5 239L228.9 44.7c9.4-9.4 24.6-9.4 33.9 0l22.7 22.7c9.4 9.4 9.4 24.5 0 33.9L131.5 256l154 154.7c9.3 9.4 9.3 24.5 0 33.9l-22.7 22.7c-9.4 9.4-24.6 9.4-33.9 0L34.5 273c-9.3-9.4-9.3-24.6 0-34zm192 34l194.3 194.3c9.4 9.4 24.6 9.4 33.9 0l22.7-22.7c9.4-9.4 9.4-24.5 0-33.9L323.5 256l154-154.7c9.3-9.4 9.3-24.5 0-33.9l-22.7-22.7c-9.4-9.4-24.6-9.4-33.9 0L226.5 239c-9.3 9.4-9.3 24.6 0 34z"}),l=1===e.currentPage,r=null!=(i=null==(s=t.firstPage)?void 0:s.call(t,{disabled:l}))?i:a;y.push(d(r,n,l))}if(e.directionLinks){const s=L({vbWidth:320,vbHeight:512,d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}),a=1===e.currentPage,l=null!=(h=null==(c=t.previous)?void 0:c.call(t,{disabled:a}))?h:s;y.push(d(l,o,a))}for(const t of a.value)y.push(d(t.title,(()=>l(t.value)),!1,t.value===e.currentPage));if(e.directionLinks){const s=L({vbWidth:320,vbHeight:512,d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}),a=e.currentPage===e.totalPages,l=null!=(f=null==(g=t.next)?void 0:g.call(t,{disabled:a}))?f:s;y.push(d(l,r,a))}if(e.boundaryLinks){const s=L({vbWidth:512,vbHeight:512,d:"M477.5 273L283.1 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.7-22.7c-9.4-9.4-9.4-24.5 0-33.9l154-154.7-154-154.7c-9.3-9.4-9.3-24.5 0-33.9l22.7-22.7c9.4-9.4 24.6-9.4 33.9 0L477.5 239c9.3 9.4 9.3 24.6 0 34zm-192-34L91.1 44.7c-9.4-9.4-24.6-9.4-33.9 0L34.5 67.4c-9.4 9.4-9.4 24.5 0 33.9l154 154.7-154 154.7c-9.3 9.4-9.3 24.5 0 33.9l22.7 22.7c9.4 9.4 24.6 9.4 33.9 0L285.5 273c9.3-9.4 9.3-24.6 0-34z"}),a=e.currentPage===e.totalPages,l=null!=(w=null==(v=t.lastPage)?void 0:v.call(t,{disabled:a}))?w:s;y.push(d(l,u,a))}return p("nav",{class:"vt-pagination"},[p("ul",{class:"pagination"},[y])])}}});m();var q={install(e,t={}){["hideSortIcons","sortIconPosition","sortHeaderClass"].forEach((e=>{t.hasOwnProperty(e)&&(k.props[e].default=t[e])})),e.component("VTable",k),e.component("VTh",I),e.component("VTr",N),e.component("VTPagination",M)}};export default q;export{e as SortOrder,A as storeKey};
